
<style type="text/css">
		.checked {
			color: orange;
		}
</style>

<nav class="navbar navbar-expand navbar-dark bg-dark static-top">

    <a class="navbar-brand mr-1" href="/admin/home">Hệ thống học điện tử</a>

    {{!-- <button style="margin-left: -650px;"class="btn btn-link btn-sm text-white order-1 order-sm-0" id="sidebarToggle" href="#">
      <i class="fas fa-bars"></i>
    </button> --}}

    <!-- Navbar Search -->
    <form class="d-none d-md-inline-block form-inline ml-auto mr-0 mr-md-3 my-2 my-md-0">
      <div class="input-group">
        <input type="text" class="form-control" placeholder="Tìm Kiếm..." aria-label="Search" aria-describedby="basic-addon2">
        <div class="input-group-append">
          <button class="btn btn-primary" type="button">
            <i class="fas fa-search"></i>
          </button>
        </div>
      </div>
    </form>

    <!-- Navbar -->
    <ul class="navbar-nav ml-auto ml-md-0">
      <li class="nav-item dropdown no-arrow mx-1">
        <a class="nav-link dropdown-toggle" href="#" id="alertsDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <i class="fas fa-bell fa-fw"></i>
          <span class="badge badge-danger">9+</span>
        </a>
        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="alertsDropdown">
          <a class="dropdown-item" href="#">Action</a>
          <a class="dropdown-item" href="#">Another action</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="#">Something else here</a>
        </div>
      </li>
      <li class="nav-item dropdown no-arrow mx-1">
        <a class="nav-link dropdown-toggle" href="#" id="messagesDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <i class="fas fa-envelope fa-fw"></i>
          <span class="badge badge-danger">7</span>
        </a>
        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="messagesDropdown">
          <a class="dropdown-item" href="#">Action</a>
          <a class="dropdown-item" href="#">Another action</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="#">Something else here</a>
        </div>
      </li>
      <li class="nav-item dropdown no-arrow">
        <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <i class="fas fa-user-circle fa-fw"></i>
        </a>
        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
          <a class="dropdown-item" href="#">Cài đặt</a>
          <a class="dropdown-item" href="/admin/profile">Hồ sơ cá nhân</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="/admin/logout" data-toggle="modal" data-target="#logoutModal">Đăng xuất</a>
        </div>
      </li>
    </ul>

  </nav>

  <div id="wrapper">

    <!-- Sidebar -->
      <ul class="sidebar navbar-nav">
      <li class="nav-item active">
        <a class="nav-link" href="./homescreen.html">
          <i class="fas fa-fw fa-tachometer-alt"></i>
          <span>Mục lục</span>
        </a>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="pagesDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <i class="fas fa-fw fa-folder"></i>
          <span>Quản lý học tập</span>
        </a>
        <div style="width: 100%" class="dropdown-menu" aria-labelledby="pagesDropdown">
                  <a class="dropdown-item" href="/admin/manage-courses">Quản lý khóa học</a>
                  <a class="dropdown-item" href="./kpi/employee_kpi.html">Quản lý chủ đề</a>
                  <a class="dropdown-item" href="./kpi/dept_kpi.html">Quản lý học liệu lớp học</a>
                  <a class="dropdown-item" href="./kpi/kpi_ems.html">Quản lý giáo viên</a>
                  <a class="dropdown-item" href="./kpi/kpi/kpi_dept.html">Quản lý người học</a>
                  <a class="dropdown-item" href="#">Quản lý đăng ký mới</a>
        </div>
      </li>      
        
       <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="pagesDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <i class="fas fa-fw fa-folder"></i>
          <span>Quản Lý Tài Khoản</span>
        </a>
        <div class="dropdown-menu" aria-labelledby="pagesDropdown">
          <a class="dropdown-item" href="/admin/manage-students-account">Tài khoản người học</a>
          <a class="dropdown-item" href="/admin/manage-teachers-account">Tài khoản giáo viên</a>
          <a class="dropdown-item" href="rp_overview.html">...</a>
        </div>
      </li>
      
       <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="pagesDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <i class="fas fa-fw fa-folder"></i>
          <span>Quản lý thông báo</span>
        </a>
        <div style=" width:100%" class="dropdown-menu" aria-labelledby="pagesDropdown">
          <a class="dropdown-item" href="../BGD/homescreen.html">Quản lý thông báo</a>
          <a class="dropdown-item" href="../TruongPhong/homescreen.html">Trưởng Phòng Marketing</a>
          <a class="dropdown-item" href="../homescreen.html">Nhân viên Phòng Marketing</a>
        </div>
      </li>       
      
    </ul>

    <div id="content-wrapper">

      <div class="container-fluid">

        <!-- Breadcrumbs-->
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            <a href="../homescreen.html">Màn hình chính</a>
          </li>
          <li class="breadcrumb-item">
             Quản lý bài luyện tập của tiết học
          </li>
        </ol>
        <div style="padding:10px" class="row">
                <div class="col-md-2">
 
                <a id="btnQuestion" class="btn btn-primary btn-block mb-3" role="button" aria-pressed="true">Thêm câu hỏi</a>
              </div>
        
        <div class="col-md-10">
          <div class="card card-primary card-outline">
            <div class="card-header">
              <h3 class="card-title">Danh sách bài tập trong tiết học {}</h3>
        <!-- Icon Cards-->
        <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
          <thead>
            <tr>
              <th>STT</th>
              <th>Câu hỏi</th>
              
              <th>Danh sách lớp</th>
              
              <th>Tùy chỉnh</th>
            </tr>
          </thead>
          <tbody id="phumaTakeda">
            {{#each allLessonQuestion}}
                <tr id={{this.id}} >
                  <td id="blabla">{{this.id}}</td>
                  <td>{{this.questionContent}}</td>
                  
                  
                  <td>
                    <input id="detailInfo" type="button" class="btn btn-info" value="Xem chi tiết"></input>
                  </td>
                  
                  
                  <td style="display: flex;">
                    <input id="btnEditQuestion" type="button" class="btn btn-warning" value="Sửa câu hỏi"></input>&nbsp;
                    <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#disable-course-modal">Xóa</button>

                  </td>
                </tr>
            {{/each}}

          </tbody>
        </table>        
                      </div>
            </div>
          </div>
          </div>
      </div>
      <!-- /.container-fluid -->
        

    </div>
</div>
</div>
        <!-- Icon Cards-->
        
      <!-- /.container-fluid -->
      
    <!-- /.content-wrapper -->

  </div>
  <!-- /#wrapper -->

  <!-- Scroll to Top Button-->
  <a class="scroll-to-top rounded" href="#page-top">
    <i class="fas fa-angle-up"></i>
  </a>

  <!-- Logout Modal-->
  <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
          <button class="close" type="button" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">×</span>
          </button>
        </div>
        <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
        <div class="modal-footer">
          <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
          <a class="btn btn-primary" href="http://localhost:3000/admin/logout">Logout</a>
        </div>
      </div>
    </div>
  </div>

<!--Confirm delete course-->
<div id="disable-course-modal" class="modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Alert</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="text-align: right;">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>Bản có chắc chắn muốn ẩn khóa học ?</p>
        <p>Chức năng sẽ ẩn cả các lớp học trong khóa</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger">Ẩn Khóa học</button>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Hủy</button>
      </div>
    </div>
  </div>
</div>
<!--Modal for Add question-->
<div id="modalQuestion" class="modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      
      <div class="modal-header">
        <h5 class="modal-title">Thêm câu hỏi vào tiết học</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="text-align: right;">
          <span aria-hidden="true">&times;</span>
        </button>
        
        
      </div>
      <div class="modal-body">
          <div class="form-group">
              <label for="exampleFormControlTextarea1">Câu hỏi</label>
              <textarea class="form-control" id="txaQuestion" rows="1" placeholder="Nội dung câu hỏi"></textarea>
          </div>
          <div class="form-group">
            <label for="exampleFormControlTextarea1">Đáp án A</label>
            <textarea class="form-control" id="txaOptionA" rows="1" placeholder="Đáp án A"></textarea>
          </div>
          <div class="form-group">
            <label for="exampleFormControlTextarea1">Đáp án B</label>
            <textarea class="form-control" id="txaOptionB" rows="1" placeholder="Đáp án B"></textarea>
          </div>
          <div class="form-group">
            <label for="exampleFormControlTextarea1">Đáp án C</label>
            <textarea class="form-control" id="txaOptionC" rows="1" placeholder="Đáp án C" ></textarea>
          </div>
          <div class="form-group">
            <label for="exampleFormControlTextarea1">Đáp án D</label>
            <textarea class="form-control" id="txaOptionD" rows="1" placeholder="Đáp án D"></textarea>
          </div>
          <hr>
          
          <div class="row">
                <div class="radio col-sm-3">   
                    <label><input type="radio" id="rdOptionA"  name="optradio">Đáp án A</label>
                </div>
                <div class="radio col-sm-3">
                    <label><input type="radio" id="rdOptionB" name="optradio">Đáp án B</label>
                </div>
                <div class="radio col-sm-3">
                    <label><input type="radio" id="rdOptionC" name="optradio">Đáp án C</label>
                </div>
                <div class="radio col-sm-3">
                    <label><input type="radio" id="rdOptionD" name="optradio">Đáp án D</label>
                </div>
          </div>
          
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-success" id="btnSubmit">Xác nhận</button>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Hủy</button>
      </div>
    </div>
  </div>
</div>
<!---->
<!--Modal for detail question-->
<div id="modalDetailQuestion" class="modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      
      <div class="modal-header">
        
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="text-align: right;">
          <span aria-hidden="true">&times;</span>
        </button>
        
        
      </div>
      <div class="modal-body">
          <h5 class="modal-title">Chi tiết câu hỏi</h5>
          <div class="form-group">
              <label for="exampleFormControlTextarea1">Câu hỏi</label>
              <textarea class="form-control" id="txaQuestionh" rows="1" placeholder="Nội dung câu hỏi"></textarea>
          </div>
          <div class="form-group">
            <label for="exampleFormControlTextarea1">Đáp án A</label>
            <textarea class="form-control" id="txaOptionAh" rows="1" placeholder="Đáp án A"></textarea>
          </div>
          <div class="form-group">
            <label for="exampleFormControlTextarea1">Đáp án B</label>
            <textarea class="form-control" id="txaOptionBh" rows="1" placeholder="Đáp án B"></textarea>
          </div>
          <div class="form-group">
            <label for="exampleFormControlTextarea1">Đáp án C</label>
            <textarea class="form-control" id="txaOptionCh" rows="1" placeholder="Đáp án C" ></textarea>
          </div>
          <div class="form-group">
            <label for="exampleFormControlTextarea1">Đáp án D</label>
            <textarea class="form-control" id="txaOptionDh" rows="1" placeholder="Đáp án D"></textarea>
          </div>
          <hr>
          
          <div class="row">
                <div class="radio col-sm-3">   
                    <label><input type="radio" id="rdOptionAh"  name="optradio">Đáp án A</label>
                </div>
                <div class="radio col-sm-3">
                    <label><input type="radio" id="rdOptionBh" name="optradio">Đáp án B</label>
                </div>
                <div class="radio col-sm-3">
                    <label><input type="radio" id="rdOptionCh" name="optradio">Đáp án C</label>
                </div>
                <div class="radio col-sm-3">
                    <label><input type="radio" id="rdOptionDh" name="optradio">Đáp án D</label>
                </div>
          </div>
          
      </div>

    </div>
  </div>
</div>
<!---->

<!--Modal for Edit question-->
<div id="modalEditQuestion" class="modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      
      <div class="modal-header">
        
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="text-align: right;">
          <span aria-hidden="true">&times;</span>
        </button>
        
        
      </div>
      <div class="modal-body">
          <h5 class="modal-title">Chỉnh sửa câu hỏi</h5>
          <div class="form-group">
              <label for="exampleFormControlTextarea1">Câu hỏi</label>
              <textarea class="form-control" id="txaQuestionn" rows="1" placeholder="Nội dung câu hỏi"></textarea>
          </div>
          <div class="form-group">
            <label for="exampleFormControlTextarea1">Đáp án A</label>
            <textarea class="form-control" id="txaOptionAn" rows="1" placeholder="Đáp án A"></textarea>
          </div>
          <div class="form-group">
            <label for="exampleFormControlTextarea1">Đáp án B</label>
            <textarea class="form-control" id="txaOptionBn" rows="1" placeholder="Đáp án B"></textarea>
          </div>
          <div class="form-group">
            <label for="exampleFormControlTextarea1">Đáp án C</label>
            <textarea class="form-control" id="txaOptionCn" rows="1" placeholder="Đáp án C" ></textarea>
          </div>
          <div class="form-group">
            <label for="exampleFormControlTextarea1">Đáp án D</label>
            <textarea class="form-control" id="txaOptionDn" rows="1" placeholder="Đáp án D"></textarea>
          </div>
          <hr>
          
          <div class="row">
                <div class="radio col-sm-3">   
                    <label><input type="radio" id="rdOptionA"  name="optradio">Đáp án A</label>
                </div>
                <div class="radio col-sm-3">
                    <label><input type="radio" id="rdOptionB" name="optradio">Đáp án B</label>
                </div>
                <div class="radio col-sm-3">
                    <label><input type="radio" id="rdOptionC" name="optradio">Đáp án C</label>
                </div>
                <div class="radio col-sm-3">
                    <label><input type="radio" id="rdOptionD" name="optradio">Đáp án D</label>
                </div>
          </div>
          
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-success" id="btnSubmit">Xác nhận thay đổi</button>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Hủy</button>
      </div>
    </div>
  </div>
</div>
<!---->

<textarea style="display: none;" class="form-control" id="clgt" rows="1" placeholder="Đáp án B">{{idLesson}}</textarea>

<!---->
<script type="text/javascript">
    $('#btnQuestion').click(function(){
        $('#modalQuestion').modal();
    })
    $('#btnEditQuestion').click(function(){
        $('#modalEditQuestion').modal();
    })

    $('#btnSubmit').click(function(){
      let questionContent = $('#txaQuestion').val().trim();
      let optionA = $('#txaOptionA').val().trim();
      let optionB = $('#txaOptionB').val().trim();
      let optionC = $('#txaOptionC').val().trim();
      let optionD = $('#txaOptionD').val().trim();
      let rightAnswer = $('#rdOptionA').is(':checked')?'A':$('#rdOptionB').is(':checked')?'B':$('#rdOptionC').is(':checked')?'C':$('#rdOptionD').is(':checked')?'D':'';
      //Validate du lieu duoc nhap vao
      if(questionContent.length==0||optionA.length==0||optionB.length==0||optionC.length==0||optionD.length==0){
        alert('Bạn chưa nhập đầy đủ câu hỏi và đáp án');
        return;
      }
      if(rightAnswer.length==0){
        alert('Bạn vui lòng chọn đáp án đúng');
        return;
      }
      //This is id of lesson 
      let id = $('#clgt').html();
     
      $.ajax({
        url:`http://localhost:3000/admin/manage-lessonquestion/create/${id}`,
        type:'post',
        data:{
          questionContent:questionContent,
          optionA:optionA,
          optionB:optionB,
          optionC:optionC,
          optionD:optionD,
          rightAnswer:rightAnswer,
          lessonId:id
        },
        success:function(data){
            $('#txaQuestion').val('');
            $('#txaOptionA').val('');
            $('#txaOptionB').val('');
            $('#txaOptionC').val('');
            $('#txaOptionD').val('');

            $('#rdOptionA').prop('checked',false);
            $('#rdOptionB').prop('checked',false);
            $('#rdOptionC').prop('checked',false);
            $('#rdOptionD').prop('checked',false);

            alert('Đã thêm câu hỏi thành công');
            
        }
      })
    })

    $('input[type=button]' ).click(function() {
        var bid = this.id; // button ID 
        var questionId = $(this).closest('tr').attr('id'); // table row ID 
        $.ajax({
          url:`http://localhost:3000/admin/manage-lessonquestion/detailQuestion/${questionId}`,
          type:'get',
          success : function(data){
            let questionDetailInfo = data.bla;
            $('#txaQuestionh').val(questionDetailInfo.questionContent);
            $('#txaOptionAh').val(questionDetailInfo.optionA);
            $('#txaOptionBh').val(questionDetailInfo.optionB);
            $('#txaOptionCh').val(questionDetailInfo.optionC);
            $('#txaOptionDh').val(questionDetailInfo.optionD);

            switch(questionDetailInfo.rightAnswer){
              case 'A':
                  $('#rdOptionAh').prop('checked',true);
                  break;
              case 'B':
                  $('#rdOptionBh').prop('checked',true);
                  break;
              case 'C':
                  $('#rdOptionCh').prop('checked',true);
                  break;
              case 'D':
                  $('#rdOptionDh').prop('checked',true);
                  break;
            }

            
          }
        })
        $('#txaQuestionh').attr('readonly','readonly');
            $('#txaOptionAh').attr('readonly','readonly');
            $('#txaOptionBh').attr('readonly','readonly');
            $('#txaOptionCh').attr('readonly','readonly');
            $('#txaOptionDh').attr('readonly','readonly');
            
            $('#rdOptionAh').attr('disabled','readonly');
            $('#rdOptionBh').attr('disabled','readonly');
            $('#rdOptionCh').attr('disabled','readonly');
            $('#rdOptionDh').attr('disabled','readonly');

            $('#modalDetailQuestion').modal();  
      });
    
</script>

<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="http://localhost:3000/js/Chart.min.js"></script>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <!-- Bootstrap core JavaScript-->
<script src="http://localhost:3000/vendor/jquery/jquery.min.js"></script>
<script src="http://localhost:3000/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
<script src="http://localhost:3000/vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Page level plugin JavaScript-->
<script src="http://localhost:3000/vendor/chart.js/Chart.min.js"></script>
<script src="http://localhost:3000/vendor/datatables/jquery.dataTables.js"></script>
<script src="http://localhost:3000/vendor/datatables/dataTables.bootstrap4.js"></script>

    <!-- Custom scripts for all pages-->
<script src="http://localhost:3000/js/sb-admin.min.js"></script>

    <!-- Demo scripts for this page-->
<script src="http://localhost:3000/js/demo/datatables-demo.js"></script>
<script src="http://localhost:3000/js/demo/chart-area-demo.js"></script>
